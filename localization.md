---
git: 46c2634ef5a4f15427c94a3157b626cf5bd3937f
---

# Локализация интерфейса


<a name="introduction"></a>
## Введение

> [!NOTE]
> По умолчанию, структура приложения Laravel не включает в себя каталог `lang`. Если вы хотите настроить языковые файлы Laravel, вы можете опубликовать их с помощью команды Artisan `lang:publish`.

Функционал локализации в Laravel позволяет удобно извлекать строки перевода для разных языков. 
Это упрощает поддержку поддержку локализации вашего приложения.

В Laravel есть два подхода к хранению строк с переводом. В первом языковые строки хранятся в php-файлах в директории `lang`.
В этой директории могут быть дополнительные директории для каждого языка, поддерживаемого вашим приложением.
Laravel использует этот подход для локализации собсвенного функционала, например, сообщений об ошибках валидации:

    /lang
        /en
            messages.php
        /es
            messages.php

Также, строки перевода могут быть расположены в файлах JSON, которые помещаются в директорию `lang`. 
При таком подходе каждый язык в вашем приложении будет иметь соответствующий файл JSON в этой директории. 
Этот способ рекомендуется для приложений с большим количеством строк для перевода:

    /lang
        en.json
        es.json

Мы обсудим каждый подход по управлению локализацией.

<a name="publishing-the-language-files"></a>
### Публикация языковых файлов

По умолчанию, структура приложения Laravel не включает в себя директорию `lang`. 
Если вы хотите настроить языковые файлы Laravel или создать собственные, 
вы можете создать директорию `lang` с помощью команды Artisan `lang:publish`. 
Команда `lang:publish` создаст директорию `lang` в вашем приложении и опубликует набор языковых файлов, используемых Laravel по умолчанию:

```shell
php artisan lang:publish
```

<a name="configuring-the-locale"></a>
### Конфигурирование языка по умолчанию

Язык по умолчанию хранится в параметре `locale` конфигурационного файла `config/app.php`. Вы указать значение, необходимое
для вашего приложения.

Вы можете изменить язык для одного HTTP-запроса во время его выполнения, используя метод `setLocale` фасада `App`:

    use Illuminate\Support\Facades\App;

    Route::get('/greeting/{locale}', function (string $locale) {
        if (! in_array($locale, ['en', 'es', 'fr'])) {
            abort(400);
        }

        App::setLocale($locale);

        // ...
    });

Вы можете указать «резервный язык», который будет использоваться, когда активный язык не содержит конкретной строки перевода. 
Как и язык по умолчанию, резервный язык также задается в конфигурационном файле `config/app.php`:

    'fallback_locale' => 'en',

<a name="determining-the-current-locale"></a>
#### Определение текущей локализации

Вы можете использовать методы фасада `App`: `currentLocale`, чтобы 
определить текущий язык или `isLocale`, чтобы проверить, соответствует ли текущий язык, указанному в методе. 

    use Illuminate\Support\Facades\App;

    $locale = App::currentLocale();

    if (App::isLocale('en')) {
        // ...
    }

<a name="pluralization-language"></a>
### Pluralization Language (множественное число)

Для преобразования единственного числа во множественное Eloquent и другие части фреймворка используют вспомогательный 
класс `Pluralizer`. Вы можете вызвать в провайдере метод `useLanguage` внутри метода `boot`, чтобы использовать для 
множественного числа язык отличный от английского. В настоящее время поддерживаются такие языки: 
`french`, `norwegian-bokmal`, `portuguese`, `spanish` и `turkish`:

```php
use Illuminate\Support\Pluralizer;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Pluralizer::useLanguage('spanish');     

    // ...     
}
```

> [!WARNING]  
> Если вы настраиваете язык множественного числа, вы должны явно определить [имена таблиц](/docs/{{version}}/eloquent#table-names) ваших моделей Eloquent.


<a name="defining-translation-strings"></a>
## Определение строк перевода

<a name="using-short-keys"></a>
### Использование коротких ключей

Обычно строки перевода хранятся в файлах в директории `lang`. В этой директории должно быть дополнительная директория 
для каждого языка, поддерживаемого вашим приложением. Это подход, который Laravel использует для управления строками 
перевода собственного функционала, например сообщений об ошибках валидации:

    /lang
        /en
            messages.php
        /es
            messages.php

Все языковые возвращают массив строк с ключами. Например:

    <?php

    // lang/en/messages.php

    return [
        'welcome' => 'Welcome to our application!',
    ];

> [!WARNING]  
> Для языков, отличающихся территориально, вы должны назвать языковые каталоги в соответствии со стандартом ISO 15897. 
> Например, для британского английского следует использовать «en_GB», а не «en-gb».

<a name="using-translation-strings-as-keys"></a>
### Использование строк перевода в качестве ключей

Для приложений с большим количеством строк локализации определение каждой строки с помощью «короткого ключа» может сбивать 
с толку при обращении к ключам в ваших шаблонах, и постоянно придумывать новые ключи для каждой строки перевода может 
быть затруднительно.

Обращение к строкам перевода с помощью «короткого ключа» в шаблонах может быть затруднительно, если в вашем приложении 
большое количество строк с переводом. Также, придумывать новые ключи может быть затруднительно.

По этой причине Laravel предлагает определение строк перевода с использованием переводимой строки в качестве ключа «по умолчанию». 
Языковые файлы, которые используют строки перевода в качестве ключей, хранятся как файлы JSON в каталоге `lang`. 
Например, если ваше приложение имеет испанский перевод, то вы должны создать файл `lang/es.json`:

```json
{
    "I love programming.": "Me encanta programar."
}
```

#### Конфликты ключей и имен файлов

Вы не должны определять строковые ключи перевода, которые конфликтуют с именами файлов перевода.
Например, перевод `__('Action')` для языка `NL` при условии существования файла `nl/action.php` и отсутствии файла `nl.json` 
приведет к тому, что переводчик Laravel вернет полное содержимое всего файла `nl/action.php`.

<a name="retrieving-translation-strings"></a>
## Получение строк перевода

Вы можете получить строки перевода из ваших языковых файлов с помощью глобального помощника `__`. Если вы используете 
«короткие ключи» для определения ваших строк перевода, то вы должны передать файл, содержащий ключ, и сам ключ в функцию `__`, 
используя «точечную нотацию». Например, давайте извлечем строку перевода `welcome` из языкового файла `lang/en/messages.php`:

    echo __('messages.welcome');

Если указанная строка перевода не существует, то функция `__` вернет ключ строки перевода. Итак, используя приведенный выше пример, 
функция `__` вернет `messages.welcome`, если строка перевода не существует.

Если вы используете свои [строки перевода в качестве ключей перевода](#using-translation-strings-as-keys), то вы должны передать перевод вашей строки по умолчанию в функцию `__`:

    echo __('I love programming.');

Опять же, если строка перевода не существует, то функция `__` вернет ключ строки перевода, который ей был передан.

Если вы используете [шаблонизатор Blade](/docs/{{version}}/blade), то вы можете использовать синтаксис `{{}}` для вывода строки перевода:

    {{ __('messages.welcome') }}

<a name="replacing-parameters-in-translation-strings"></a>
### Замена параметров в строках перевода

При желании вы можете определить плейсхолдер в строках перевода. Все плейсхолдеры имеют префикс `:`. Например, вы 
можете определить приветственное сообщение с плейсхолдером:

    'welcome' => 'Welcome, :name',

Чтобы заменить плейсхолдер при получении строки перевода, вы можете передать массив для замены в качестве второго аргумента функции `__`:

    echo __('messages.welcome', ['name' => 'dayle']);

Если все буквы плейсхолдер заглавные или плейсхолдер имеет только первую заглавную букву, то переведенное значение будет с соответствующим регистром:

    'welcome' => 'Welcome, :NAME', // Welcome, DAYLE
    'goodbye' => 'Goodbye, :Name', // Goodbye, Dayle

<a name="object-replacement-formatting"></a>
#### Форматирование объектов при подстановке

Когда вы пытаетесь использовать объект в качестве плейсхолдер перевода, Laravel автоматически вызывает метод `__toString` этого объекта. 
Метод [`__toString`](https://www.php.net/manual/en/language.oop5.magic.php#object.tostring) является одним из встроенных "магических" методов в PHP. 
Однако бывают случаи, когда у вас нет контроля над методом `__toString` определенного класса, особенно если это класс сторонней библиотеки.

В таких ситуациях Laravel предоставляет возможность зарегистрировать пользовательский обработчик форматирования для конкретного типа объекта.
Для этого используется метод `stringable` фасада `Lang`.
Метод `stringable` принимает замыкание, которое должно указать тип объекта, для которого выполняется форматирование.
Обычно вызов метода `stringable` выполняется в методе `boot` класса `AppServiceProvider` вашего приложения:

```php
use Illuminate\Support\Facades\Lang;
use Money\Money;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Lang::stringable(function (Money $money) {
        return $money->formatTo('en_GB');
    });
}
```

<a name="pluralization"></a>
### Плюрализация (множественное число)

Плюрализация – сложная задача, поскольку разные языки имеют множество сложных правил плюрализации; 
однако Laravel может помочь вам переводить строки по-разному в зависимости от правил множественного числа, которые вы указываете. 
Используя мета-символ `|`, вы можете назначать формы единственного и множественного числа строки:

    'apples' => 'There is one apple|There are many apples',

Конечно, множественное число также поддерживается при использовании [строк перевода в качестве ключей](#using-translation-strings-as-keys):

```json
{
    "There is one apple|There are many apples": "Hay una manzana|Hay muchas manzanas"
}
```

Вы даже можете создать более сложные правила множественного числа, которые определяют строки перевода для нескольких диапазонов значений:

    'apples' => '{0} There are none|[1,19] There are some|[20,*] There are many',

После определения строки перевода, которая имеет параметры множественного числа, вы можете использовать функцию `trans_choice` 
для извлечения строки соответствующую указанному «количеству». В этом примере, поскольку количество больше единицы, возвращается форма множественного числа строки перевода:

    echo trans_choice('messages.apples', 10);

Вы также можете определить плейсхолдер в строках множественного числа. Эти плейсхолдеры могут быть заменены значениями 
из массива, указанного в качестве третьего аргумента функции `trans_choice`:

    'minutes_ago' => '{1} :value minute ago|[2,*] :value minutes ago',

    echo trans_choice('time.minutes_ago', 5, ['value' => 5]);

Если вы хотите отобразить целочисленное значение, переданное в функцию `trans_choice`, то вы можете использовать встроенный заполнитель `:count`:

    'apples' => '{0} There are none|{1} There is one|[2,*] There are :count',

<a name="handling-missing-translation-strings"></a>
### Обработка отсутствующих ключей перевода

Обычно, при попытке перевода строки, для которой нет соответствующего ключа в ваших файлах перевода, Laravel вернет ключ строки перевода.

Вы можете настроить или перехватить это поведение с помощью метода `handleMissingKeysUsing`. Обычно это делается в методе `boot` класса `AppServiceProvider`:

```php
use Illuminate\Support\Facades\Lang;

/**
 * Bootstrap any application services.
 */
public function boot(): void
{
    Lang::handleMissingKeysUsing(function (string $key, array $replacements, string $locale) {
        info("Обнаружен отсутствующий ключ перевода [$key].");

        return $key;
    });
}
```

Этот подход позволяет вам настроить действие, выполняемое при отсутствии ключей перевода, например, для логирования или другой обработки.

<a name="overriding-package-language-files"></a>
## Переопределение языковых файлов пакета

Некоторые пакеты могут содержать собственные языковые файлы. Вместо того чтобы изменять строки файлов пакета, вы можете 
переопределить их, поместив файлы в каталог `lang/vendor/{package}/{locale}`.

Так, например, если вам нужно переопределить строки перевода на английский в `messages.php` для пакета с именем `skyrim/hearthfire`, 
вы должны поместить языковой файл в каталог: `lang/vendor/hearthfire/en/messages.php`. В этом файле вы должны указать 
только те строки перевода, которые хотите переопределить. Любые строки перевода, которые вы не меняете, 
все равно будут загружены из исходных языковых файлов пакета.
